\# SQL JOIN Queries



This script (`joins\_queries.sql`) provides examples of different types of SQL JOIN clauses to retrieve data from a relational database, such as one that might power a property rental application like Airbnb.



\## Assumed Database Schema



The queries are based on a hypothetical schema consisting of the following tables:



\-   \*\*`users`\*\*: Stores user information.

&nbsp;   -   `user\_id` (Primary Key)

&nbsp;   -   `username`

&nbsp;   -   `email`

\-   \*\*`properties`\*\*: Stores property listing details.

&nbsp;   -   `property\_id` (Primary Key)

&nbsp;   -   `title`

&nbsp;   -   `location`

\-   \*\*`bookings`\*\*: Stores booking records, linking users to properties.

&nbsp;   -   `booking\_id` (Primary Key)

&nbsp;   -   `user\_id` (Foreign Key to `users`)

&nbsp;   -   `property\_id` (Foreign Key to `properties`)

\-   \*\*`reviews`\*\*: Stores reviews for properties.

&nbsp;   -   `review\_id` (Primary Key)

&nbsp;   -   `property\_id` (Foreign Key to `properties`)

&nbsp;   -   `user\_id` (Foreign Key to `users`)

&nbsp;   -   `rating`

&nbsp;   -   `comment`



\## Queries Included



\### 1. INNER JOIN



\-   \*\*Purpose\*\*: To retrieve all bookings along with the details of the user who made each booking.

\-   \*\*Result\*\*: This query will only return rows where a booking has a corresponding user. Bookings without a user or users without a booking will be excluded.



\### 2. LEFT JOIN



\-   \*\*Purpose\*\*: To retrieve all properties and any reviews they may have.

\-   \*\*Result\*\*: This query lists every property from the `properties` table. If a property has reviews, the review details will be included. If a property has no reviews, the review-related columns will be `NULL`.



\### 3. FULL OUTER JOIN



\-   \*\*Purpose\*\*: To retrieve all users and all bookings, showing the relationship between them.

\-   \*\*Result\*\*: This query combines all records from both the `users` and `bookings` tables. It will show:

&nbsp;   -   Users who have made bookings.

&nbsp;   -   Users who have not made any bookings.

&nbsp;   -   Bookings that are not associated with any user (e.g., orphaned records).



\*\*Note on Compatibility\*\*: The `FULL OUTER JOIN` is standard in SQL databases like PostgreSQL and SQL Server but is not available in MySQL.


# SQL Subqueries

This script (`subqueries.sql`) provides examples of both correlated and non-correlated SQL subqueries. A subquery, or inner query, is a query nested inside another SQL query.

## Assumed Database Schema

The queries are based on a hypothetical schema for a property rental application:

-   **`users`**: Stores user information (`user_id`, `username`).
-   **`properties`**: Stores property details (`property_id`, `title`).
-   **`bookings`**: Records bookings, linking users to properties (`booking_id`, `user_id`).
-   **`reviews`**: Stores property reviews (`review_id`, `property_id`, `rating`).

## Queries Included

### 1. Non-Correlated Subquery

-   **Purpose**: To find all properties with an average rating greater than 4.0.
-   **How it works**: A non-correlated subquery is an independent query whose output is used by the outer query.
    1.  The inner query first calculates the average rating for each property and returns a list of `property_id`s that have an average rating above 4.0.
    2.  The outer query then selects all details from the `properties` table where the `property_id` is in the list generated by the inner query.

### 2. Correlated Subquery

-   **Purpose**: To find all users who have made more than 3 bookings.
-   **How it works**: A correlated subquery depends on the outer query for its values. It is executed once for each row evaluated by the outer query.
    1.  The outer query iterates through each user in the `users` table.
    2.  For each user, the inner query is executed. It counts the total number of bookings in the `bookings` table that belong to that specific user (`WHERE b.user_id = u.user_id`).
    3.  The outer query's `WHERE` clause then checks if this count is greater than 3. If it is, the user is included in the final result set.
